# PR Service

### –ê–≤—Ç–æ—Ä: –ú–∏–Ω—å–∫–æ –°–µ—Ä–≥–µ–π
### –Ø–∑—ã–∫: `Golang`
### –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö: `PostgreSQL`
### –¢–µ—Å—Ç–æ–≤–æ–µ –∑–∞–¥–∞–Ω–∏–µ –¥–ª—è —Å—Ç–∞–∂—ë—Ä–∞ (–æ—Å–µ–Ω–Ω—è—è –≤–æ–ª–Ω–∞ 2025)

---
# –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ
1. [–û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞](#–æ–ø–∏—Å–∞–Ω–∏–µ-–ø—Ä–æ–µ–∫—Ç–∞)
2. [–ó–∞–ø—É—Å–∫](#–∑–∞–ø—É—Å–∫)
    - [–°–æ–±—Ä–∞–Ω–∏–µ –¥–æ–∫–µ—Ä–∞](#—Å–æ–±—Ä–∞–Ω–∏–µ-–¥–æ–∫–µ—Ä–∞)
    - [Docker Compose —Å –ø—Ä–æ—Ñ–∏–ª—è–º–∏](#docker-compose-—Å-–ø—Ä–æ—Ñ–∏–ª—è–º–∏)
        - [–ü—Ä–æ—Ñ–∏–ª—å `app` (–æ—Å–Ω–æ–≤–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ)](#–ø—Ä–æ—Ñ–∏–ª—å-app-–æ—Å–Ω–æ–≤–Ω–æ–µ-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ)
        - [–ü—Ä–æ—Ñ–∏–ª—å `test` (—Ç–µ—Å—Ç–æ–≤–∞—è –±–∞–∑–∞ –∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã)](#–ø—Ä–æ—Ñ–∏–ª—å-test-—Ç–µ—Å—Ç–æ–≤–∞—è-–±–∞–∑–∞-–∏-–∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ-—Ç–µ—Å—Ç—ã)
    - [–ü—Ä–æ–≤–µ—Ä–∫–∞ —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤](#–ø—Ä–æ–≤–µ—Ä–∫–∞-—ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤)
3. [–î–æ–ø—É—â–µ–Ω–∏—è](#–¥–æ–ø—É—â–µ–Ω–∏—è)
    - [–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `id` –≤ —Ñ–æ—Ä–º–∞—Ç–µ UUID –≤ —Ç–∞–±–ª–∏—Ü–µ `teams`](#–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ-id-–≤-—Ñ–æ—Ä–º–∞—Ç–µ-uuid-–≤-—Ç–∞–±–ª–∏—Ü–µ-teams)
    - [–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ ORM (GORM)](#–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ-orm-gorm)
    - [–ö–∞—Å–∫–∞–¥–Ω–∞—è –º–æ–¥–µ–ª—å —Å–≤—è–∑–µ–π –≤ –ë–î](#–∫–∞—Å–∫–∞–¥–Ω–∞—è-–º–æ–¥–µ–ª—å-—Å–≤—è–∑–µ–π-–≤-–±–¥)
4. [–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ](#—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ)
    - [–ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤](#–∑–∞–ø—É—Å–∫-—Ç–µ—Å—Ç–æ–≤)
    - [–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è (.env –∏ .env.test)](#–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ-–ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö-–æ–∫—Ä—É–∂–µ–Ω–∏—è-env-–∏-envtest)
    - [–ù–∞–≥—Ä—É–∑–æ—á–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ](#–Ω–∞–≥—Ä—É–∑–æ—á–Ω–æ–µ-—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ)
        - [–£—Å—Ç–∞–Ω–æ–≤–∫–∞ k6](#—É—Å—Ç–∞–Ω–æ–≤–∫–∞-k6)
        - [–ó–∞–ø—É—Å–∫ –Ω–∞–≥—Ä—É–∑–æ—á–Ω–æ–≥–æ —Ç–µ—Å—Ç–∞](#–∑–∞–ø—É—Å–∫-–Ω–∞–≥—Ä—É–∑–æ—á–Ω–æ–≥–æ-—Ç–µ—Å—Ç–∞)
        - [–ò—Ç–æ–≥–æ–≤—ã–µ –º–µ—Ç—Ä–∏–∫–∏](#–∏—Ç–æ–≥–æ–≤—ã–µ-–º–µ—Ç—Ä–∏–∫–∏)
5. [–õ–∏–Ω—Ç–µ—Ä](#–ª–∏–Ω—Ç–µ—Ä)
    - [–£—Å—Ç–∞–Ω–æ–≤–∫–∞](#—É—Å—Ç–∞–Ω–æ–≤–∫–∞)
    - [–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∏ –∑–∞–ø—É—Å–∫](#–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è-–∏-–∑–∞–ø—É—Å–∫)
## –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞

–°–µ—Ä–≤–∏—Å –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫–æ–º–∞–Ω–¥–∞–º–∏, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ –∏ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è–º–∏ —Ä–µ–≤—å—é–µ—Ä–æ–≤ –Ω–∞ pull request'—ã.

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏:**

- **–ü–æ–ª–Ω—ã–π –Ω–∞–±–æ—Ä CRUD-–æ–ø–µ—Ä–∞—Ü–∏–π**  
  –°–æ–∑–¥–∞–Ω–∏–µ, —á—Ç–µ–Ω–∏–µ, –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏ —É–¥–∞–ª–µ–Ω–∏–µ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –∫–æ–º–∞–Ω–¥ –∏ PR.

- **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ ORM GORM**  
  –•–æ—Ç—è GORM —Å—á–∏—Ç–∞–µ—Ç—Å—è —Å–ø–æ—Ä–Ω—ã–º —Ä–µ—à–µ–Ω–∏–µ–º, –¥–ª—è —Ç–µ–∫—É—â–µ–≥–æ —É—Ä–æ–≤–Ω—è –æ–Ω —Ç–æ–ª—å–∫–æ —É–ø—Ä–æ—â–∞–µ—Ç —Ä–∞–∑—Ä–∞–±–æ—Ç–∫—É.

- **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π**  
  –ö—Ä–∏—Ç–∏—á–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –º–∞—Å—Å–æ–≤–∞—è –¥–µ–∞–∫—Ç–∏–≤–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–≤—è–∑–∞–Ω–Ω—ã—Ö –¥–µ–π—Å—Ç–≤–∏–π) –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –≤ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è—Ö, —á—Ç–æ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö –∏ –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏—è —Å–∏—Å—Ç–µ–º—ã.

- **–ò–Ω–¥–µ–∫—Å—ã –≤ –ë–î**
  –î–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö –±—ã–ª–∏ —Å–æ–∑–¥–∞–Ω—ã –∏–Ω–¥–µ–∫—Å—ã B-Tree

- **–ú–∞—Å—Å–æ–≤–∞—è –¥–µ–∞–∫—Ç–∏–≤–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∫–æ–º–∞–Ω–¥—ã**  
  –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –∫–∞–∫ –∞—Ç–æ–º–∞—Ä–Ω–∞—è –æ–ø–µ—Ä–∞—Ü–∏—è –≤–Ω—É—Ç—Ä–∏ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏, —á—Ç–æ –∏—Å–∫–ª—é—á–∞–µ—Ç —á–∞—Å—Ç–∏—á–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö.

- **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∏—Å—Ç–æ—Ä–∏–∏ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–π —Ä–µ–≤—å—é–µ—Ä–æ–≤**  
  –ö–∞–∂–¥–æ–µ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ —Ñ–∏–∫—Å–∏—Ä—É–µ—Ç—Å—è –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–π —Ç–∞–±–ª–∏—Ü–µ.

- **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—é —Ä–µ–≤—å—é–µ—Ä–æ–≤**  
  –ü–æ–∑–≤–æ–ª—è–µ—Ç —Å—á–∏—Ç–∞—Ç—å –Ω–∞–≥—Ä—É–∑–∫—É –Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞—Ç—å –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–µ —Å—Ä–µ–∑—ã.

- **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã –Ω–∞ –æ—Ç–¥–µ–ª—å–Ω–æ–π —Ç–µ—Å—Ç–æ–≤–æ–π –±–∞–∑–µ**  
  –ü—Ä–æ—Ñ–∏–ª—å `test` –ø–æ–¥–Ω–∏–º–∞–µ—Ç —Ç–µ—Å—Ç–æ–≤—É—é –ë–î –∏ –∑–∞–ø—É—Å–∫–∞–µ—Ç –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω–æ.

---

# –ó–∞–ø—É—Å–∫

## –°–æ–±—Ä–∞–Ω–∏–µ –¥–æ–∫–µ—Ä–∞
–ß—Ç–æ–±—ã –∑–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–æ–µ–∫—Ç, –≤–≤–µ–¥–∏—Ç–µ –∫–æ–º–∞–Ω–¥—É:
```bash
  docker-compose up --build
```

## Docker Compose —Å –ø—Ä–æ—Ñ–∏–ª—è–º–∏

–í –ø—Ä–æ–µ–∫—Ç–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–≤–∞ –ø—Ä–æ—Ñ–∏–ª—è:

- `app` ‚Äì –æ—Å–Ω–æ–≤–Ω–æ–π —Å–µ—Ä–≤–∏—Å –∏ –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
- `test` ‚Äì —Ç–µ—Å—Ç–æ–≤–∞—è –±–∞–∑–∞ –∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã

### –ü—Ä–æ—Ñ–∏–ª—å `app` (–æ—Å–Ω–æ–≤–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ)

–ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –∏ –æ—Å–Ω–æ–≤–Ω–æ–π –ë–î:

```bash
docker-compose --profile app up -d
```

–û—Å—Ç–∞–Ω–æ–≤–∫–∞:
```bash
docker-compose --profile app down
```

### –ü—Ä–æ—Ñ–∏–ª—å `test` (—Ç–µ—Å—Ç–æ–≤–∞—è –±–∞–∑–∞ –∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã)
–ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤:

```bash
docker-compose --profile test up -d
```

–û—Å—Ç–∞–Ω–æ–≤–∫–∞:
```bash
docker-compose --profile test down
```

## –ü—Ä–æ–≤–µ—Ä–∫–∞ —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤

### –ù–∏–∂–µ –ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω—ã –æ—Å–Ω–æ–≤–Ω—ã–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã –¥–ª—è –≤—Å—Ç–∞–≤–∫–∏ –≤ –∫–æ–Ω—Å–æ–ª—å, —Å–æ–≤–µ—Ç—É—é –≤—ã–ø–æ–ª–Ω—è—Ç—å –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ:
- –°–æ–∑–¥–∞–Ω–∏–µ –∫–æ–º–∞–Ω–¥—ã:
```bash
curl -X POST http://localhost:8080/team/add \
  -H "Content-Type: application/json" \
  -d '{
    "team_name": "payments",
    "members": [
      { "user_id": "u1", "username": "Alice", "is_active": true },
      { "user_id": "u2", "username": "Bob", "is_active": true },
      { "user_id": "u3", "username": "Charlie", "is_active": true },
      { "user_id": "u4", "username": "Kim", "is_active": true }
    ]
  }'
```
- –ü–æ–ª—É—á–µ–Ω–∏–µ –∫–æ–º–∞–Ω–¥—ã –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞:
```bash
curl -X GET http://localhost:8080/team/get?team_name=payments
```
- –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –Ω–µ–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ `user`:
```bash
curl -X POST http://localhost:8080/users/setIsActive \
  -H "Content-Type: application/json" \
  -d '{
    "user_id": "u3",
    "is_active": false
  }'
```
- –í–æ–∑–≤—Ä–∞—â–µ–Ω–∏–µ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ `user`:
```bash
curl -X POST http://localhost:8080/users/setIsActive \
  -H "Content-Type: application/json" \
  -d '{
    "user_id": "u3",
    "is_active": true
  }'
```
- –°–æ–∑–¥–∞–Ω–∏–µ `pull request'–∞`:
```bash
curl -X POST http://localhost:8080/pullRequest/create \
  -H "Content-Type: application/json" \
  -d '{
    "pull_request_id": "pr-1",
    "pull_request_name": "Add payments module",
    "author_id": "u1"
  }'
```
- –ü—Ä–æ—Å–º–æ—Ç—Ä `pull request'–æ–≤`, –≥–¥–µ `user` –Ω–∞–∑–Ω–∞—á–µ–Ω —Ä–µ–≤—å—é–µ—Ä–æ–º:
```bash
curl "http://localhost:8080/users/getReview?user_id=u2"
```
- –ü–µ—Ä–µ–Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ —Ä–µ–≤—å—é–µ—Ä–∞:
```bash
curl -X POST http://localhost:8080/pullRequest/reassign \
  -H "Content-Type: application/json" \
  -d '{
    "pull_request_id": "pr-1",
    "old_user_id": "u4"
  }'
```

- –ü–æ–º–µ—Ç–∫–∞ `PR` –∫–∞–∫ `MERGED`:
```bash
curl -X POST http://localhost:8080/pullRequest/merge \
  -H "Content-Type: application/json" \
  -d '{"pull_request_id": "pr-1"}'
```
- –ü–µ—Ä–µ–Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ —Ä–µ–≤—å—é–≤–µ—Ä–∞:
```bash
curl -X POST http://localhost:8080/pullRequest/reassign \
  -H "Content-Type: application/json" \
  -d '{
    "pull_request_id": "pr-1",
    "old_user_id": "u4"
  }'
```

### –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —ç–Ω–¥–ø–æ–∏—Ç—ã:
- –ú–∞—Å—Å–æ–≤–∞—è –¥–µ–∞–∫—Ç–∏–≤–∞—Ü–∏—è –≤—Å–µ–π –∫–æ–º–∞–Ω–¥—ã:
```bash
curl -X POST http://localhost:8080/team/deactivate_users \
  -H "Content-Type: application/json" \
  -d '{
    "team_name": "frontend",
}'
```
- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–π:
```bash
curl -X GET http://localhost:8080/stats/reviewers
```

- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏ —Å–µ—Ä–≤–∏—Å–∞:
```bash
curl -X GET http://localhost:8080/health
```

## –î–æ–ø—É—â–µ–Ω–∏—è

### üîπ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `id` –≤ —Ñ–æ—Ä–º–∞—Ç–µ UUID –≤ —Ç–∞–±–ª–∏—Ü–µ `teams`
–í —Ç–∞–±–ª–∏—Ü–∞—Ö `teams` –∏ `reviewer_assignment_histories` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø–æ–ª–µ `id` —Ç–∏–ø–∞ **UUID**, –Ω–µ—Å–º–æ—Ç—Ä—è –Ω–∞ —Ç–æ —á—Ç–æ –ø–æ –∑–∞–¥–∞–Ω–∏—é –º–æ–∂–Ω–æ –±—ã–ª–æ –æ–±–æ–π—Ç–∏—Å—å –∏–º–µ–Ω–µ–º –∫–æ–º–∞–Ω–¥—ã.
–≠—Ç–æ —Ä–µ—à–µ–Ω–∏–µ –ø—Ä–∏–Ω—è—Ç–æ, –ø–æ—Ç–æ–º—É —á—Ç–æ:

- –ø—Ä–∏ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–∏ —Å–∏—Å—Ç–µ–º—ã –∏–º—è –∫–æ–º–∞–Ω–¥—ã –ø–µ—Ä–µ—Å—Ç–∞—ë—Ç –±—ã—Ç—å –Ω–∞–¥—ë–∂–Ω—ã–º –Ω–∞—Ç—É—Ä–∞–ª—å–Ω—ã–º –∫–ª—é—á–æ–º (–ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ, –ª–æ–∫–∞–ª–∏–∑–∞—Ü–∏–∏, –∫–æ–Ω—Ñ–ª–∏–∫—Ç—ã);
- UUID –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç—å –≤ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã—Ö —Å–∏—Å—Ç–µ–º–∞—Ö –±–µ–∑ –æ–±—Ä–∞—â–µ–Ω–∏—è –∫ –ë–î;
- —É–ø—Ä–æ—â–∞–µ—Ç —Å–≤—è–∑–∏ –º–µ–∂–¥—É —Ç–∞–±–ª–∏—Ü–∞–º–∏ –∏ –ø–æ–∑–≤–æ–ª—è–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤–Ω–µ—à–Ω–∏–µ –∫–ª—é—á–∏ –±–µ–∑ —Ä–∏—Å–∫–∞ –∫–æ–ª–ª–∏–∑–∏–π.

---

### üîπ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ ORM (GORM)
ORM —á–∞—Å—Ç–æ —Å—á–∏—Ç–∞—é—Ç **–∞–Ω—Ç–∏–ø–∞—Ç—Ç–µ—Ä–Ω–æ–º** –∏–∑-–∑–∞:

- —Å–∫—Ä—ã—Ç—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π,
- –Ω–µ—è–≤–Ω—ã—Ö SQL-–∑–∞–ø—Ä–æ—Å–æ–≤,
- –Ω–µ–æ–ø—Ç–∏–º–∞–ª—å–Ω–æ—Å—Ç–∏ –ø—Ä–∏ —Å–ª–æ–∂–Ω—ã—Ö –≤—ã–±–æ—Ä–∫–∞—Ö.

–û–¥–Ω–∞–∫–æ –≤ —Ç–µ–∫—É—â–µ–º –ø—Ä–æ–µ–∫—Ç–µ:

- –∑–∞–ø—Ä–æ—Å—ã –ø—Ä–æ—Å—Ç—ã–µ –∏ –Ω–µ–±–æ–ª—å—à–∏–µ,
- –Ω–µ—Ç —Ç—è–∂—ë–ª—ã—Ö –∞–≥—Ä–µ–≥–∞—Ü–∏–π,
- —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö —Å—Ç–∞–±–∏–ª—å–Ω–∞.

–ü–æ—ç—Ç–æ–º—É –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ GORM –≤ —ç—Ç–æ–º —Å–ª—É—á–∞–µ **–≤–∞–ª–∏–¥–Ω–æ –∏ —É–ø—Ä–æ—â–∞–µ—Ç —Ä–∞–∑—Ä–∞–±–æ—Ç–∫—É**.

---

### üîπ –ö–∞—Å–∫–∞–¥–Ω–∞—è –º–æ–¥–µ–ª—å —Å–≤—è–∑–µ–π –≤ –ë–î
–í—Å–µ –≤–Ω–µ—à–Ω–∏–µ –∫–ª—é—á–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã —Å –∫–∞—Å–∫–∞–¥–Ω—ã–º–∏ –ø—Ä–∞–≤–∏–ª–∞–º–∏ (`ON DELETE CASCADE`).

–ü–ª—é—Å—ã —Ç–∞–∫–æ–≥–æ –ø–æ–¥—Ö–æ–¥–∞:

- –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö;
- —É–¥–∞–ª–µ–Ω–∏–µ –æ–±—ä–µ–∫—Ç–æ–≤ –Ω–µ –æ—Å—Ç–∞–≤–ª—è–µ—Ç ¬´–º—É—Å–æ—Ä–Ω—ã–µ¬ª –∑–∞–≤–∏—Å–∏–º—ã–µ –∑–∞–ø–∏—Å–∏;
- —É–ø—Ä–æ—â–∞–µ—Ç—Å—è –ª–æ–≥–∏–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è ‚Äî –ë–î —Å–∞–º–∞ –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å.


# –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

## –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤

–°—Ü–µ–Ω–∞—Ä–∏–π —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞—Å—Ç —Ç–µ—Å—Ç–æ–≤—É—é –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö (`pr_service_test`), –µ—Å–ª–∏ –æ–Ω–∞ –µ—â—ë –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç.

–ï—Å–ª–∏ –≤–æ–∑–Ω–∏–∫–∞–µ—Ç –æ—à–∏–±–∫–∞ –≤–æ –≤—Ä–µ–º—è –∑–∞–ø—É—Å–∫–∞ `docker-compose --profile test up -d`, —Ç–æ –º–æ–∂–Ω–æ –∑–∞–ø—É—Å—Ç–∏—Ç—å —á–µ—Ä–µ–∑ `go`:
```bash
go test ./tests/integration
```

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è (.env –∏ .env.test)

–î–ª—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è —Ñ–∞–π–ª—ã –æ–∫—Ä—É–∂–µ–Ω–∏—è, –ø–æ–∑–≤–æ–ª—è—é—â–∏–µ —Ä–∞–∑–¥–µ–ª—è—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–ª—è —Ä–∞–±–æ—á–µ–≥–æ –∏ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è.

---

## üìÑ **–ü—Ä–∏–º–µ—Ä —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ `.env` –¥–ª—è –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è**

```env
DB_DSN=postgres://postgres:postgres@db:5432/pr_service?sslmode=disable
DB_MAX_OPEN_CONNS=10
DB_MAX_IDLE_CONNS=5
DB_CONN_MAX_LIFETIME=300
DB_MIGRATION_PATH=./migrations
```

## üìÑ **–ü—Ä–∏–º–µ—Ä —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ `.env.test` –¥–ª—è —Ç–µ—Å—Ç–æ–≤**

```env
DB_DSN=postgres://postgres:postgres@db-test:5432/pr_service_test?sslmode=disable
DB_MAX_OPEN_CONNS=5
DB_MAX_IDLE_CONNS=2
DB_CONN_MAX_LIFETIME=60
DB_MIGRATION_PATH=../../migrations
```

–ï—Å–ª–∏ —Ö–æ—Ç–∏—Ç–µ –∑–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–æ–µ–∫—Ç –±–µ–∑ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è `docker-compose`, —Ç–æ –≤ `DB_DSN` –Ω–∞–∑–≤–∞–Ω–∏—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤(`db/b-test`) –∑–∞–º–µ–Ω–∏—Ç—å –Ω–∞ `localhost`.

## –ù–∞–≥—Ä—É–∑–æ—á–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
–î–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ API –ø—Ä–æ–≤–æ–¥–∏–ª–æ—Å—å –Ω–∞–≥—Ä—É–∑–æ—á–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å –ø–æ–º–æ—â—å—é –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞ **k6**.

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞ k6

–î–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ ***k6*** –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å snap:
```bash
sudo snap install k6
```
### –£—Å—Ç–∞–Ω–æ–≤–∫–∞ k6
–°—Ü–µ–Ω–∞—Ä–∏–π —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ —Ñ–∞–π–ª–µ:
```bash
./tests/load/load_test.js
```

### –ó–∞–ø—É—Å–∫ –Ω–∞–≥—Ä—É–∑–æ—á–Ω–æ–≥–æ —Ç–µ—Å—Ç–∞

–ó–∞–ø—É—Å–∫ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç—Å—è —Å –ø–æ–º–æ—â—å—é –∫–æ–º–∞–Ω–¥—ã:
```bash
k6 run ./tests/load/load_test.js
```

–í —Ç–µ—Å—Ç–µ —Å–æ–∑–¥–∞—é—Ç—Å—è –∫–æ–º–∞–Ω–¥—ã –∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏, –∑–∞—Ç–µ–º –æ—Å—É—â–µ—Å—Ç–≤–ª—è–µ—Ç—Å—è —á–µ—Ä–µ–¥–æ–≤–∞–Ω–∏–µ –¥–µ–π—Å—Ç–≤–∏–π:

#### üîπ –°–æ–∑–¥–∞–Ω–∏–µ Pull Request

#### üîπ –ú–µ—Ä–∂ Pull Request

#### üîπ –¢–æ–≥–≥–ª–∏–Ω–≥ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

#### üîπ –ü–æ–ª—É—á–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–π —Ä–µ–≤—å—é–µ—Ä–æ–≤

### –†–µ–∑—É–ª—å—Ç–∞—Ç —Ä–∞–±–æ—Ç—ã –Ω–∞–≥—Ä—É–∑–æ—á–Ω–æ–≥–æ —Ç–µ—Å—Ç–∞
```
         /\      Grafana   /‚Äæ‚Äæ/  
    /\  /  \     |\  __   /  /   
/  \/    \    | |/ /  /   ‚Äæ‚Äæ\
/          \   |   (  |  (‚Äæ)  |
/ __________ \  |_|\_\  \_____/

     execution: local
        script: tests/load/load_test.js
        output: -

     scenarios: (100.00%) 1 scenario, 10 max VUs, 5m30s max duration (incl. graceful stop):
              * default: 10 looping VUs for 5m0s (gracefulStop: 30s)



‚ñà TOTAL RESULTS

    checks_total.......: 10580   35.11706/s
    checks_succeeded...: 100.00% 10580 out of 10580
    checks_failed......: 0.00%   0 out of 10580

    ‚úì setup team created or exists
    ‚úì PR created or conflict
    ‚úì stats fetched
    ‚úì PR merged or already merged

    HTTP
    http_req_duration..............: avg=4.85ms   min=699.32¬µs med=4.45ms   max=25.87ms p(90)=7.09ms   p(95)=7.56ms  
      { expected_response:true }...: avg=4.85ms   min=699.32¬µs med=4.45ms   max=25.87ms p(90)=7.09ms   p(95)=7.56ms  
    http_req_failed................: 0.00%  0 out of 14482
    http_reqs......................: 14482  48.068551/s

    EXECUTION
    iteration_duration.............: avg=769.93ms min=512.47ms med=769.78ms max=1.04s   p(90)=971.77ms p(95)=995.59ms
    iterations.....................: 3902   12.95149/s
    vus............................: 4      min=4          max=10
    vus_max........................: 10     min=10         max=10

    NETWORK
    data_received..................: 100 MB 333 kB/s
    data_sent......................: 3.0 MB 9.9 kB/s




running (5m01.3s), 00/10 VUs, 3902 complete and 0 interrupted iterations
default ‚úì [======================================] 10 VUs  5m0s
```
### –ò—Ç–æ–≥–æ–≤—ã–µ –º–µ—Ç—Ä–∏–∫–∏

| –ú–µ—Ç—Ä–∏–∫–∞                     | –¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ (SLA/SLI)            | –§–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ         | –°—Ç–∞—Ç—É—Å        |
|-----------------------------|---------------------------------|------------------------------|---------------|
| **–£—Å–ø–µ—à–Ω–æ—Å—Ç—å –∑–∞–ø—Ä–æ—Å–æ–≤**     | ‚â• 99.9% (SLI)                   | 100%                         | –í—ã–ø–æ–ª–Ω–µ–Ω–æ     |
| **–°—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è –æ—Ç–≤–µ—Ç–∞**    | ‚â§ 100 ms (SLA)                  | 4.85 ms                      | –í—ã–ø–æ–ª–Ω–µ–Ω–æ     |
| **–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è –æ—Ç–≤–µ—Ç–∞** | ‚â§ 300 ms (SLA)                 | 25.87 ms                     | –í—ã–ø–æ–ª–Ω–µ–Ω–æ     |
| **RPS (–∑–∞–ø—Ä–æ—Å–æ–≤ –≤ —Å–µ–∫—É–Ω–¥—É)**| ‚â• 5 (SLI)                        | 48.07                        | –í—ã–ø–æ–ª–Ω–µ–Ω–æ     |
| **–û–±—ä—ë–º –¥–∞–Ω–Ω—ã—Ö**            | –¥–æ 20 –∫–æ–º–∞–Ω–¥, –¥–æ 200 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π | 20 –∫–æ–º–∞–Ω–¥, 300 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π | –ü–µ—Ä–µ–≤—ã–ø–æ–ª–Ω–µ–Ω–æ |

> –ü–æ –∏—Ç–æ–≥–∞–º –Ω–∞–≥—Ä—É–∑–æ—á–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –≤—Å–µ –∑–∞—è–≤–ª–µ–Ω–Ω—ã–µ SLA/SLI –±—ã–ª–∏ –ø–æ–ª–Ω–æ—Å—Ç—å—é –¥–æ—Å—Ç–∏–≥–Ω—É—Ç—ã.

## –õ–∏–Ω—Ç–µ—Ä

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞
–î–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –≤–≤–µ–¥–∏—Ç–µ –∫–æ–º–∞–Ω–¥—É:
```bash
sudo snap install golangci-lint --classic
```
### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∏ –∑–∞–ø—É—Å–∫ 
–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤:
```
.gonangci.yml
```
–ê –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –∑–∞–ø—É—Å—Ç–∏—Ç—å –∫–æ–º–∞–Ω–¥—É:
```bash
golangci-lint run
```